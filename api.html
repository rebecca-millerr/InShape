<!DOCTYPE HTML>

<html>
	<head>
        
	<meta name="viewport" content="width=device-width, initial-scale=1.0" charset="utf-8">
	
	<title>Nutrition Api</title>
	</head>

	
	<body>
			
<div class="food-container"></div>
<div class= "macros"></div>

	

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

		<script language="Javascript" type="text/javascript">
        

        //IMPORTANT*****************************************************************************************
        var calories = "1800";
        var diet = "none";          //These are the parameters that go into the api, the documentation on it can be found here:
        var allergies = "peanut";     //https://spoonacular.com/food-api/docs#Generate-Meal-Plan
        //IMPORTANT****************************************************************************
        
        var foodname = [];
        var foodimg = [];
        var preptime = [];
        var macros = [];
        var ingredients = [];
        var percentCarbs = [];
        var percentFat = [];
        var percentProtein = [];
        
        $.getJSON("https://api.spoonacular.com/recipes/mealplans/generate?apiKey=048a26721a2a416a944e45becc2d10aa&timeFrame=day&targetCalories=" +
                 calories + "&diet=" + diet + "&exclude" + allergies, function(data){
        
            
            var cals = data.nutrients.calories;
            var carbs = data.nutrients.carbohydrates;
            var fat = data.nutrients.fat;
            var protein = data.nutrients.protein;
           
		
            for (i = 0; i < 3; i++ ){
                foodname[i] = data.meals[i].title;
                
                preptime[i] = data.meals[i].readyInMinutes;
               
				var $container = $('<div class = "container">').addClass('food' + i);
                
                
                $.getJSON(" https://api.spoonacular.com/recipes/"+ data.meals[i].id +"/information?apiKey=048a26721a2a416a944e45becc2d10aa&includeNutrition=true", 
                function(recipeinfo){
                    percentCarbs[i] = recipeinfo.nutrition.caloricBreakdown.percentCarbs;       // Each of the arrays hold integer values of the percentages of macros
                    percentFat[i] = recipeinfo.nutrition.caloricBreakdown.percentFat;           // Index values correspond to different meals. To get macro percentage 
                    percentProtein[i] = recipeinfo.nutrition.caloricBreakdown.percentProtein;   // for each food, use same index number for each array.
                });

                var $title = $('<h2>').text(foodname[i]);
                var $preptime = $('<p>').text("Preperation time: " + preptime[i]);
                var $image = $('<img>').attr("src","https://spoonacular.com/recipeImages/" + data.meals[i].id + "-240x150.jpg");
				$container.append($title,$preptime,$image);
				$('.food-container').append($container);

                


            };

            var $carbos = $('<div>').text("Your daily macronutrients: Carbohydrates:" + carbs);
            var $fats = $('<div>').text("Your daily macronutrients: Fat:" + fat);
            var $protein = $('<div>').text("Your daily macronutrients: Protein:" + protein);
            var $calories = $('<div>').text("Your daily calorie intake: " + cals + "calories");
    
            $('.macros').append($carbos,$fats,$protein,$calories);
            
            // console.log(foodname);
            // console.log(preptime);
            // console.log(macros);
        });

        
        

				

		
		</script>

	</body>
</html>
